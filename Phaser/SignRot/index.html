<!doctype html>
<html>
    <head>
        <meta charset="UTF-8" />
        <title>hello phaser!</title>
        <script src="phaser.js"></script>
    </head>
    <body>

    <script type="text/javascript">

    window.onload = function() {

        var game = new Phaser.Game(800, 600, Phaser.AUTO, '', { preload: preload, create: create, update: update });

        function preload () {

            game.load.image('sign_top', '/images/Wilderness Sign.png');
            game.load.image('sign_bot', '/images/Welcome Sign.png');
            game.load.image('chain_r', '/images/chain_r.png');
            game.load.image('chain_l', '/images/chain_l.png');

        }

        var sign;
        var pole;
        var signBot;

        var maxForce = 20000;

        function create () {

            game.physics.startSystem(Phaser.Physics.P2JS);
            //game.physics.p2.gravity.y = 200;

            var signTop = game.add.sprite(game.world.centerX + 40, game.world.centerY, 'sign_top');
            signTop.anchor.setTo(.5, .5);
            signTop.scale.setTo(.5, .5)

            signBot = game.add.sprite(game.world.centerX, game.world.centerY, 'sign_bot');
            signBot.anchor.setTo(.5, .5);
            signBot.scale.setTo(.5, .5);

            var chainR = game.add.sprite(game.world.centerX + 100, game.world.centerY, 'chain_r');
            chainR.anchor.setTo(.5, .5);
            chainR.scale.setTo(.5, .5);

            var chainL = game.add.sprite(game.world.centerX - 100, game.world.centerY, 'chain_l');
            chainL.anchor.setTo(.5, .5);
            chainL.scale.setTo(.5, .5);

//            pole = game.add.sprite(game.world.centerX, game.world.centerY + 100, 'pole');
//            pole.anchor.setTo(0.5, .5);
//            pole.scale.setTo(0.6, 0.6);
//
//            sign = game.add.sprite(game.world.centerX, game.world.centerY - 200, 'sign');
//            sign.anchor.setTo(0.5, 0.5);
//            sign.scale.setTo(0.4, 0.4);
            game.physics.p2.enable([chainL, chainR, signBot, signTop]);

            chainL.body.clearCollision(true,true);
            chainR.body.clearCollision(true,true);
            signBot.body.clearCollision(true,true);
            signTop.body.clearCollision(true,true);

//            var lockConstraint
            var rotConstraintChainR = game.physics.p2.createRevoluteConstraint(signBot, [-10, 0], chainR, [0, 10]);
            var rotConstraintChainL = game.physics.p2.createRevoluteConstraint(chainL, [0, -10], signTop, [-180, -40]);
            var rotConstraintSign = game.physics.p2.createRevoluteConstraint(signBot, [-210, -40], chainL, [0, 10]);

            cursors = game.input.keyboard.createCursorKeys();
        }

        function update () {
            if(cursors.left.isDown){
                signBot.body.moveLeft(50);
            }
        }

    };

    </script>

    </body>
</html>